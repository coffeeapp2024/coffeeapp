(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[583],{7035:function(e,r,t){Promise.resolve().then(t.bind(t,5947))},5947:function(e,r,t){"use strict";t.r(r);var n=t(7437),o=t(2265),a=t(6540),c=t(6885),u=t(9396),i=t(8884);r.default=function(){let{role:e}=(0,i.bL)(),[r,t]=(0,o.useState)([]);(0,o.useEffect)(()=>{r.length>0&&r.forEach((e,r)=>{let t=document.getElementById("qr-code-".concat(r));if(t){let e=t.toDataURL(),r=document.createElement("a");r.href=e,r.download="qr-code.png",document.body.appendChild(r),r.click(),document.body.removeChild(r)}})},[r]);let s=async()=>{try{let e=await (0,c.t7)(1);t(e)}catch(e){console.error("Error generating keys:",e)}};return(0,n.jsxs)("div",{className:"flex items-center flex-col justify-center",children:[(0,n.jsx)("div",{className:"hidden",children:r.map((e,r)=>(0,n.jsx)("div",{children:(0,n.jsx)(a.ZP,{id:"qr-code-".concat(r),value:e,includeMargin:!0})},r))}),(0,n.jsx)("button",{className:"".concat("manager"===e?"":"pointer-events-none grayscale"),onClick:s,children:(0,n.jsx)(u.Z,{text:"Create QR"})})]})}},9396:function(e,r,t){"use strict";var n=t(7437);t(2265),r.Z=function(e){let{text:r}=e;return(0,n.jsx)("div",{className:"relative z-10 active:scale-95 transition-transform",children:(0,n.jsxs)("div",{className:"bg-gradient-to-tr from-amber-300 to-amber-400 h-11 px-4 flex items-center justify-center rounded-xl text-xl text-neutral-800 font-bold text-nowrap border-[1px] border-neutral-800 -z-10 shadow-lg",children:[r,(0,n.jsx)("div",{className:"absolute w-full h-full -z-20 top-[3px] left-1 rounded-xl bg-neutral-800"})]})})}},4499:function(e,r,t){"use strict";t.d(r,{Ap:function(){return s},I8:function(){return i},db:function(){return l},tO:function(){return d}});var n=t(6142),o=t(8121),a=t(2730),c=t(4905);let u=(0,n.ZF)({apiKey:"AIzaSyC5L-FI5QWb_uDeUdEbeSEmpMwAr9P8ze4",authDomain:"coffee-coin-app.firebaseapp.com",projectId:"coffee-coin-app",storageBucket:"coffee-coin-app.appspot.com",messagingSenderId:"53756991092",appId:"1:53756991092:web:abb9e522247df5f0f6e321",measurementId:"G-PV6MFHBST4"}),i=(0,a.v0)(u),s=new a.hJ,l=(0,o.ad)(u),d=(0,c.cF)(u)},6885:function(e,r,t){"use strict";t.d(r,{FG:function(){return P},FQ:function(){return g},Pv:function(){return p},XX:function(){return E},YA:function(){return J},Yh:function(){return C},a4:function(){return k},ck:function(){return v},n8:function(){return w},t7:function(){return y},uL:function(){return m},vL:function(){return N},vV:function(){return T},vz:function(){return L},wY:function(){return b},x4:function(){return U},zS:function(){return x}});var n=t(8121),o=t(4499),a=t(4905);let c=(0,n.hJ)(o.db,"users"),u=(0,n.hJ)(o.db,"contents"),i=(0,n.hJ)(o.db,"keys"),s=(0,n.hJ)(o.db,"vouchers"),l=(0,n.hJ)(o.db,"game_random_voucher"),d=(0,n.hJ)(o.db,"levels"),f=(0,n.hJ)(o.db,"products"),h=(0,n.hJ)(o.db,"productTags");async function m(e){let r=(0,n.JU)(c,e.uid);try{if((await (0,n.QT)(r)).exists()||!e.email||!e.displayName)return console.error("User data already exists or user data is incomplete"),null;{let t={email:e.email,displayName:e.displayName,coin:0,balance:.1,startTimeMine:null,endTimeMine:null,voucherIdList:[],LikedEventImageIdList:[],LikedCheckinImageIdList:[]};return await (0,n.pl)(r,t),t}}catch(e){throw console.error("Error creating user data:",e),e}}async function g(e){let r=(0,n.JU)(c,e);try{let e=await (0,n.QT)(r);if(e.exists())return e.data();return console.log("User data not found"),null}catch(e){throw console.error("Error fetching user data:",e),e}}async function p(e,r){let t=(0,n.JU)(c,e);try{await (0,n.pl)(t,r,{merge:!0}),console.log("User data updated successfully")}catch(e){throw console.error("Error updating user data:",e),e}}async function y(e){let r=[];try{for(let t=0;t<e;t++){let e=(0,n.JU)(i),t=e.id;await (0,n.pl)(e,{key:t}),r.push(t)}return r}catch(e){throw console.error("Error generating and saving keys:",e),e}}async function v(){try{let e=await (0,n.PL)(i),r=[];return e.forEach(e=>{let t=e.id;r.push(t)}),r}catch(e){throw console.error("Error fetching keys from Firestore:",e),e}}async function w(e){try{await (0,n.oe)((0,n.JU)(i,e)),console.log("Key deleted successfully:",e)}catch(e){throw console.error("Error deleting key from Firestore:",e),e}}async function b(){try{let e=await (0,n.PL)(s),r=[];return e.forEach(e=>{r.push({id:e.id,...e.data()})}),r}catch(e){throw console.error("Error fetching vouchers from Firestore:",e),e}}async function E(){try{let e=await (0,n.PL)(l),r=[];return e.forEach(e=>{r.push({id:e.id,...e.data()})}),r}catch(e){throw console.error("Error fetching cases from Firestore:",e),e}}async function U(){try{let e=await (0,n.PL)(d),r=[];return e.forEach(e=>{r.push({id:e.id,...e.data()})}),r}catch(e){throw console.error("Error fetching levels from Firestore:",e),e}}function x(e,r){let t=(0,n.JU)(c,e);try{return(0,n.cf)(t,e=>{if(e.exists()){let t=e.data().voucherIdList||[];r(t)}else console.log("User data not found")})}catch(e){throw console.error("Error listening for voucherIdList changes:",e),e}}async function I(e,r){try{let t=(0,a.iH)(o.tO,"".concat(r,"/").concat(e.name)),n=await (0,a.B0)(t,e);return await (0,a.Jt)(n.ref)}catch(e){throw console.error("Error uploading image to Firebase Storage:",e),e}}async function k(e,r,t,a){try{let c=await I(e,a);return{id:(await (0,n.ET)((0,n.hJ)(o.db,a),{userEmail:t,userId:r,imageURL:c,likedNumber:0})).id,userEmail:t,userId:r,imageURL:c,likedNumber:0}}catch(e){throw console.error("Error uploading image and adding to collection:",e),e}}async function L(e,r,t){try{if(!e){console.error("Error updating liked number: ID is empty");return}let a=(0,n.JU)((0,n.hJ)(o.db,t),e);await (0,n.r7)(a,{likedNumber:r}),console.log("Liked number updated successfully.")}catch(e){throw console.error("Error updating liked number:",e),e}}async function J(e){try{let r=await (0,n.PL)((0,n.hJ)(o.db,e)),t=[];return r.forEach(e=>{var r,n,o,a;let c=e.data(),u={id:e.id,userEmail:null!==(r=c.userEmail)&&void 0!==r?r:null,userId:null!==(n=c.userId)&&void 0!==n?n:null,imageURL:null!==(o=c.imageURL)&&void 0!==o?o:null,likedNumber:null!==(a=c.likedNumber)&&void 0!==a?a:0};t.push(u)}),t}catch(e){throw console.error("Error fetching post images:",e),e}}async function N(){try{let e=await (0,n.PL)(f),r=[];return e.forEach(e=>{let t=e.data(),n={id:e.id,img:t.img,name:t.name,price:t.price,tags:t.tags};r.push(n)}),r}catch(e){throw console.error("Error fetching products from Firestore:",e),e}}async function P(){try{let e=await (0,n.PL)(h),r=[];return e.forEach(e=>{let t=e.data();if(t.name&&t.tag){let e={name:t.name,tag:t.tag};r.push(e)}}),r}catch(e){throw console.error("Error fetching product tags from Firestore:",e),e}}async function C(){try{let e=await (0,n.QT)((0,n.JU)(u,"shopPage"));if(!e.exists())return console.log("Document 'shop' does not exist"),null;{let r=e.data(),t=null==r?void 0:r.banner;if(t)return console.log("Banner fetched"),t;return console.log("Banner not found in shop content"),null}}catch(e){throw console.error("Error fetching shop content:",e),e}}async function T(e,r,t){try{let o=(0,n.JU)(c,e),a=await (0,n.QT)(o);if(a.exists()){let{voucherIdList:n}=a.data();if(!n||t>=n.length)throw Error("Invalid index or missing voucherIdList");n.splice(t,1),await p(e,{voucherIdList:n}),console.log("Voucher ID ".concat(r," deleted successfully from user ").concat(e))}else console.log("User ".concat(e," not found"))}catch(e){throw console.error("Error deleting voucher ID from user:",e),e}}},8884:function(e,r,t){"use strict";t.d(r,{Bv:function(){return g},Ep:function(){return i},Kk:function(){return u},MB:function(){return p},OX:function(){return y},Q6:function(){return l},U:function(){return f},Uc:function(){return c},Ur:function(){return s},aD:function(){return m},bL:function(){return o},dk:function(){return w},jc:function(){return v},ny:function(){return h},xE:function(){return a}});var n=t(2020);let o=(0,n.Ue)(e=>({userData:null,userId:null,role:null,setUserData:r=>e({userData:r}),setUserId:r=>e({userId:r}),setRole:r=>e({role:r})})),a=(0,n.Ue)(e=>({homePageContent:null,setHomePageContent:r=>e({homePageContent:r})})),c=(0,n.Ue)(e=>({remainingTimeSeconds:null,setRemainingTimeSeconds:r=>e({remainingTimeSeconds:r})})),u=(0,n.Ue)(e=>({currentCoin:null,setCurrentCoin:r=>e({currentCoin:r})})),i=(0,n.Ue)(e=>({vouchers:null,setVouchers:r=>e({vouchers:r})})),s=(0,n.Ue)(e=>({cases:null,setCases:r=>e({cases:[...r]})})),l=(0,n.Ue)(e=>({levels:null,setLevels:r=>e({levels:r})}));function d(e,r){return(0,n.Ue)(t=>({name:e,posts:r,setName:e=>t({name:e}),setPosts:e=>t({posts:e}),addPost:async e=>{t(r=>({posts:[e,...r.posts]}))},setLikedNumber:async(e,r)=>{let n;return t(t=>{var o;let a=t.posts.map(t=>{var n;return t.id===e?{...t,likedNumber:(null!==(n=t.likedNumber)&&void 0!==n?n:0)+(r?1:-1)}:t});return n=null===(o=a.find(r=>r.id===e))||void 0===o?void 0:o.likedNumber,{...t,posts:a}}),null!=n?n:0}}))}let f=d("eventImages",[]),h=d("checkinImages",[]),m=(0,n.Ue)(e=>({products:null,setProducts:r=>e({products:r})})),g=(0,n.Ue)(e=>({productTags:null,currentTag:"all",setProductTags:r=>e({productTags:r}),setCurrentTag:r=>e({currentTag:r})})),p=(0,n.Ue)(e=>({banner:null,setBanner:r=>e({banner:r})})),y=(0,n.Ue)(e=>({randomVoucherId:null,open:!1,setRandomVoucherId:r=>e({randomVoucherId:r}),setOpen:r=>e({open:r})})),v=(0,n.Ue)(e=>({voucherId:null,index:null,open:!1,setVoucherId:r=>e({voucherId:r}),setIndex:r=>e({index:r}),setOpen:r=>e({open:r})})),w=(0,n.Ue)(e=>({minePageContent:null,setMinePageContent:r=>e({minePageContent:r})}))}},function(e){e.O(0,[358,124,199,540,971,69,744],function(){return e(e.s=7035)}),_N_E=e.O()}]);